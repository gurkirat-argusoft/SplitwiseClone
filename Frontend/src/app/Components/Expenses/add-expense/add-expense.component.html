<!-- Modal -->
<div class="modal fade" id="addExpenseModel" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Add New Expense</h5>
        <button type="button" (click)="onCancel()" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>

      <form [formGroup]="expenseForm" (ngSubmit)="onSubmit()" class="expense-form">
        <div class="modal-body">

          <div class="mb-3">
            <label for="expenseType" class="form-label">Expense Type:</label>
            <select id="expenseType" [(ngModel)]="expenseType" formControlName="expenseType" class="form-select">
              <option value="">Select Type</option>
              <option value="group">Group</option>
              <option value="friends">Friends</option>
              <option value="event">Event</option>
            </select>
          </div>

          <div *ngIf="expenseForm.get('expenseType')?.value === 'group'" class="mb-3">
            <label for="group" class="form-label">Group:</label>
            <select id="group" formControlName="group" class="form-select">
              <option *ngFor="let group of groups" [value]="group">{{group}}</option>
            </select>
          </div>

          <div *ngIf="expenseForm.get('expenseType')?.value === 'friends'" class="mb-3">
            <label for="friend" class="form-label">Add friends:</label>
            <select id="friend" (change)="onFriendsSelect($event)" formControlName="friends" class="form-select">
              <option *ngFor="let friend of friends" [value]="friend">{{friend}}</option>
            </select>

            @if(selectedFriends.length){
            <div class="mt-3">
              <h6>Selected Friends:</h6>
              <div class="selected-friends-container">
                <div *ngFor="let selectedFriend of selectedFriends; let i = index"
                  class="selected-friend d-flex justify-content-between align-items-center">
                  <span>{{selectedFriend}}</span>
                  <button type="button" (click)="removeFriend(i,selectedFriend)"
                    class="remove-button btn btn-sm btn-danger">Ã—</button>
                </div>
              </div>
            </div>
            }

          </div>

          <div *ngIf="expenseForm.get('expenseType')?.value === 'event'" class="mb-3">
            <div class="mb-3">
              <label for="event" class="form-label">Event:</label>
              <input type="text" id="event" formControlName="event" class="form-control">
            </div>
          </div>

          <div class="mb-3">
            <label for="amount" class="form-label">Amount:</label>
            <input type="number" id="amount" formControlName="amount" class="form-control">
          </div>
          
          <!-- amount input validation -->
          <div *ngIf="expenseForm.get('amount')?.invalid && expenseForm.get('amount')?.touched" class="text-danger">
            Amount is required
          </div>

          <div class="mb-3">
            <label for="description" class="form-label">Description:</label>
            <input type="text" id="description" formControlName="description" class="form-control">
          </div>

          <div class="mb-3">
            <label for="date" class="form-label">Date:</label>
            <input type="date" id="date" formControlName="date" class="form-control">
          </div>

          <!-- date input validation -->
          <div *ngIf="expenseForm.get('date')?.invalid && expenseForm.get('date')?.touched" class="text-danger">
            Date is required
          </div>

        </div>
        <div class="modal-footer">
          <div class="d-flex justify-content-between w-100">
            <button type="button" (click)="onCancel()" class="btn btn-secondary btn-danger cancel-button" data-dismiss="modal">
              Close
            </button>
            <button type="submit" (click)="onSubmit()" [disabled]="!expenseForm.valid" class="btn btn-primary submit-button">
              Add Expense
            </button>
          </div>
        </div>

      </form>
    </div>
  </div>
</div>